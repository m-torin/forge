---
title: Google Gemini Setup Guide
description:
  Complete guide to setting up and using Google Gemini models with full feature
  support
---

# Google Gemini Setup Guide

This guide explains how to set up and use Google Gemini models with full feature
support in the AI Chatbot.

## Prerequisites

1. Google Cloud account with Generative AI API access
2. API key for Google Generative AI

## Setup Steps

### 1. Obtain Google Generative AI API Key

1. Go to [Google AI Studio](https://aistudio.google.com/app/apikey)
2. Create a new API key or use an existing one
3. Copy the API key

### 2. Configure Environment Variables

Add the following to your `.env.local` file:

```bash
# Required
GOOGLE_GENERATIVE_AI_API_KEY=your-api-key-here

# Optional - Google Gemini Features
GOOGLE_SAFETY_THRESHOLD=BLOCK_MEDIUM_AND_ABOVE # BLOCK_NONE, BLOCK_LOW_AND_ABOVE, BLOCK_MEDIUM_AND_ABOVE, BLOCK_ONLY_HIGH
GOOGLE_SEARCH_GROUNDING_ENABLED=false          # Set to 'true' to enable web search grounding
GOOGLE_CACHE_TTL_SECONDS=3600                  # Cache TTL for long conversations (1 hour default)
```

Or use Doppler:

```bash
doppler secrets set GOOGLE_GENERATIVE_AI_API_KEY="your-api-key-here"
doppler secrets set GOOGLE_SAFETY_THRESHOLD="BLOCK_MEDIUM_AND_ABOVE"
doppler secrets set GOOGLE_SEARCH_GROUNDING_ENABLED="false"
doppler secrets set GOOGLE_CACHE_TTL_SECONDS="3600"
```

### 3. Available Models

The following Google Gemini models are now available:

- **Gemini 1.5 Pro** (`gemini-1.5-pro-latest`)
  - Most capable model with 2M context window
  - Supports text, vision, tools, and structured output
  - Best for complex tasks and long contexts

- **Gemini 1.5 Flash** (`gemini-1.5-flash`)
  - Fast and efficient model with 1M context window
  - Good balance of speed and capability
  - Best for quick responses and moderate tasks

- **Gemini 2.0 Flash (Experimental)** (`gemini-2.0-flash-exp`)
  - Next-generation experimental model
  - Latest features and improvements
  - Best for testing cutting-edge capabilities

## Features

### Multi-modal Support

All Gemini models support image inputs. Simply attach images to your messages
and the system will automatically convert them for vision tasks.

### Advanced Safety Settings

Configurable safety filters with four levels:

- `BLOCK_NONE` - No filtering
- `BLOCK_LOW_AND_ABOVE` - Block low-risk and above
- `BLOCK_MEDIUM_AND_ABOVE` - Block medium-risk and above (default)
- `BLOCK_ONLY_HIGH` - Block only high-risk content

Safety ratings are logged and tracked for monitoring.

### Search Grounding

Enable real-time web search capabilities by setting
`GOOGLE_SEARCH_GROUNDING_ENABLED=true`. When enabled:

- Models can access current web information
- Search queries and results are logged
- Grounding metadata is captured for transparency

### Intelligent Content Caching

Automatic caching for improved performance and cost reduction:

- Automatically enabled for conversations longer than 5000 characters
- Configurable TTL via `GOOGLE_CACHE_TTL_SECONDS`
- Cache hits/misses are logged for monitoring
- Reduces token costs for repetitive content

### File Input Support

Enhanced file handling capabilities:

- Images (PNG, JPG, etc.) for vision tasks
- PDF documents for analysis
- Automatic conversion between attachment formats

### Structured Output Generation

Full support for structured data generation with:

- Zod schema validation
- Array and object output modes
- Google-specific schema preprocessing (handles limitations like union types)

## Usage

1. Start the development server:

   ```bash
   pnpm dev --filter=ai-chatbot
   ```

2. Select a Gemini model from the model dropdown in the chat interface

3. Start chatting! You can:
   - Send text messages
   - Upload images for vision tasks
   - Use tools like weather, document creation, etc.

## Troubleshooting

### "API key not valid" error

- Verify your API key is correct
- Ensure the Generative AI API is enabled in your Google Cloud project
- Check that your API key has the necessary permissions

### Model not appearing in dropdown

- Ensure you've restarted the development server after adding the API key
- Check the browser console for any errors
- Verify the environment variable is loaded correctly

### Safety errors

- Some content may be blocked by safety filters
- Try rephrasing your request
- Adjust `GOOGLE_SAFETY_THRESHOLD` to a more permissive level
- Check the console logs for safety ratings

### Search grounding not working

- Ensure `GOOGLE_SEARCH_GROUNDING_ENABLED=true` is set
- Check console logs for grounding activation messages
- Verify your API key has search capabilities enabled

### Caching issues

- Check console logs for caching activation messages
- Verify `GOOGLE_CACHE_TTL_SECONDS` is set correctly
- Long conversations (>5000 chars) automatically enable caching

## Advanced Configuration

### Custom Safety Settings

You can adjust safety thresholds by setting environment variables:

```bash
# More permissive
GOOGLE_SAFETY_THRESHOLD=BLOCK_ONLY_HIGH

# More restrictive
GOOGLE_SAFETY_THRESHOLD=BLOCK_LOW_AND_ABOVE

# No filtering (use with caution)
GOOGLE_SAFETY_THRESHOLD=BLOCK_NONE
```

### Enabling Search Grounding

To enable web search capabilities:

```bash
GOOGLE_SEARCH_GROUNDING_ENABLED=true
```

### Custom Cache Settings

Adjust caching behavior:

```bash
# 2 hours cache
GOOGLE_CACHE_TTL_SECONDS=7200

# 30 minutes cache
GOOGLE_CACHE_TTL_SECONDS=1800
```

## Monitoring and Logging

The system provides detailed logging for:

- Safety ratings and content filtering
- Search grounding queries and results
- Cache hits/misses and performance
- Model selection and configuration
- File attachment processing

Check your console logs for detailed information about Google Gemini operations.
