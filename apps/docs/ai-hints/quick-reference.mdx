---
title: Quick Reference
description: Summary of all packages and their key details
icon: "list"
---

# Quick Reference

Essential information about all packages in the Forge monorepo for quick lookup.

## Package Overview

| Package                      | Purpose                        | Layer | Edge Support | Key Import                                               |
| ---------------------------- | ------------------------------ | ----- | ------------ | -------------------------------------------------------- |
| `@repo/auth`                 | Better Auth with organizations | 5     | ✅           | `auth` from `/server/next`                               |
| `@repo/database`             | Prisma ORM + generated types   | 3     | ❌           | `import { prisma }` from `/prisma/server/next`           |
| `@repo/analytics`            | PostHog/GA with feature flags  | 4     | ✅           | `import { analytics }`                                   |
| `@repo/observability`        | Sentry error tracking          | 2     | ✅           | `createServerObservability` from `/server/next`          |
| `@repo/notifications`        | Mantine notifications          | 4     | ✅           | `/mantine-notifications`                                 |
| `@repo/email`                | Email templates and sending    | 4     | ❌           | `import { sendEmail }`                                   |
| `@repo/storage`              | Cloudflare R2/Images           | 5.5   | ✅           | `import { initializeStorage, createStorageProvider }`    |
| `@repo/payments`             | Stripe integration             | 5     | ❌           | `import { stripe }`                                      |
| `@repo/ai`                   | AI/ML functionality            | 5.5   | ✅           | `import { getBestModelForTask }` from `/models`          |
| `@repo/scraping`             | Web scraping utilities         | 5.5   | ❌           | `import { scraper }`                                     |
| `@repo/feature-flags`        | Feature flag management        | 4     | ✅           | `import { flags }`                                       |
| `@repo/internationalization` | i18n support                   | 5     | ✅           | `import { i18n }`                                        |
| `@repo/seo`                  | SEO utilities                  | 5     | ✅           | `import { createStructuredData, JsonLd }`                |
| `@repo/links`                | Link management                | 5     | ✅           | `import { createServerLinkManager }` from `/server/next` |
| `@repo/orchestration`        | Workflow management            | 5     | ❌           | `import { workflow }`                                    |
| `@repo/security`             | Security utilities             | 2     | ✅           | `import { security }`                                    |
| `@repo/qa`                   | Testing utilities              | 2     | ✅           | `import { testUtils }`                                   |

## Import Patterns

### Next.js Apps

```typescript
// Server components/actions
import { auth } from "@repo/auth/server/next";
import { createServerObservability } from "@repo/observability/server/next";

// Client components
import { useAuth } from "@repo/auth/client/next";
import { getObservability } from "@repo/observability/client/next";

// Middleware
import { auth } from "@repo/auth/server/edge";
import { createEdgeObservability } from "@repo/observability/server/edge";
```

### Node.js Workers/Scripts

```typescript
// Node.js only
import { createAuth } from "@repo/auth/server";
import { createServerObservability } from "@repo/observability/server";
```

## Environment Variables

### Required for All Apps

```bash
# Database
DATABASE_URL=postgresql://...

# Auth
AUTH_SECRET=your-secret-key
AUTH_URL=http://localhost:3000

# Environment
NODE_ENV=development
```

### Optional (Auto-activates when set)

```bash
# Sentry
SENTRY_DSN=https://xxx@sentry.io/yyy

# PostHog
NEXT_PUBLIC_POSTHOG_KEY=your-key
POSTHOG_HOST=https://app.posthog.com

# Cloudflare
CLOUDFLARE_ACCOUNT_ID=your-account-id
CLOUDFLARE_API_TOKEN=your-token

# Stripe
STRIPE_SECRET_KEY=sk_test_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
```

## Common Commands

### Development

```bash
# Install dependencies
pnpm install

# Run development server
pnpm dev

# Type checking
pnpm typecheck

# Linting
pnpm lint

# Testing
pnpm test
```

### Database

```bash
# Run migrations
pnpm migrate

# Generate Prisma client
pnpm --filter @repo/database generate

# Open Prisma Studio
cd packages/database && pnpm dev
```

### Building

```bash
# Build all apps
pnpm build

# Build specific app
pnpm build --filter=app-name

# Production build with Doppler
pnpm build:doppler
```

## Testing Patterns

### Component Tests

```typescript
import { render, screen } from '@testing-library/react';
import { Component } from './Component';

test('renders component', () => {
  render(<Component data-testid="test-component" />);
  expect(screen.getByTestId('test-component')).toBeInTheDocument();
});
```

### Server Action Tests

```typescript
import { testAction } from "@repo/qa/server-actions";

test("creates user", async () => {
  const result = await testAction(createUser, {
    email: "test@example.com",
    name: "Test User"
  });

  expect(result.success).toBe(true);
});
```

### E2E Tests

```typescript
import { test, expect } from "@playwright/test";

test("user can sign up", async ({ page }) => {
  await page.goto("/signup");
  await page.fill('[data-testid="email-input"]', "test@example.com");
  await page.click('[data-testid="submit-button"]');
  await expect(page).toHaveURL("/dashboard");
});
```

## Error Handling Patterns

### Server Actions

```typescript
export async function createUser(formData: FormData) {
  try {
    const validated = userSchema.parse(Object.fromEntries(formData));
    const user = await db.user.create({ data: validated });
    return { success: true, user };
  } catch (error) {
    return { success: false, error: "Failed to create user" };
  }
}
```

### API Routes

```typescript
export async function POST(request: Request) {
  try {
    const data = await request.json();
    // Process data
    return NextResponse.json({ success: true });
  } catch (error) {
    return NextResponse.json(
      { error: "Internal server error" },
      { status: 500 }
    );
  }
}
```

## Form Patterns

### Mantine + Zod

```typescript
import { useForm } from "@mantine/form";
import { zodResolver } from "mantine-form-zod-resolver";
import { z } from "zod";

const schema = z.object({
  email: z.string().email(),
  name: z.string().min(2)
});

const form = useForm({
  validate: zodResolver(schema),
  initialValues: { email: "", name: "" }
});
```

## Authentication Patterns

### Protected Server Component

```typescript
import { auth } from '@repo/auth/server/next';
import { redirect } from 'next/navigation';

export default async function ProtectedPage() {
  const session = await auth();
  if (!session) redirect('/login');

  return <div>Welcome {session.user.name}</div>;
}
```

### Protected Server Action

```typescript
import { auth } from "@repo/auth/server/next";

export async function protectedAction() {
  const session = await auth();
  if (!session) {
    throw new Error("Unauthorized");
  }

  // Use session.user.id for user operations
}
```

## Database Patterns

### Basic CRUD

```typescript
import { prisma } from "@repo/database/prisma/server/next";

// Create
const user = await prisma.user.create({
  data: { email: "test@example.com", name: "Test" }
});

// Read
const user = await prisma.user.findUnique({
  where: { id: userId }
});

// Update
const updated = await prisma.user.update({
  where: { id: userId },
  data: { name: "New Name" }
});

// Delete
await prisma.user.delete({
  where: { id: userId }
});
```

### Complex Queries

```typescript
const users = await prisma.user.findMany({
  where: {
    posts: {
      some: { published: true }
    }
  },
  include: {
    posts: {
      where: { published: true },
      orderBy: { createdAt: "desc" }
    }
  }
});
```

## File Structure Patterns

### Package Structure

```
packages/package-name/
├── package.json
├── src/
│   ├── index.ts          # Main exports
│   ├── server/           # Server-side code
│   │   ├── next.ts       # Next.js server
│   │   └── edge.ts       # Edge runtime
│   ├── client/           # Client-side code
│   │   └── next.ts       # Next.js client
│   └── shared/           # Shared utilities
├── env.ts                # Environment validation
└── __tests__/            # Tests
```

### App Structure

```
apps/app-name/
├── app/                  # Next.js app directory
│   ├── actions/          # Server actions
│   ├── components/       # Components
│   └── lib/              # Utilities
├── components/           # Shared components
├── env.ts                # Environment validation
└── __tests__/            # Tests
```

## Common Gotchas

### ❌ Don't do this

```typescript
// Direct process.env access in client components
"use client";
const apiKey = process.env.API_KEY; // ❌

// Using server imports in client
("use client");
import { auth } from "@repo/auth/server/next"; // ❌

// Forgetting to regenerate Prisma client
// After schema changes, always run:
// pnpm --filter @repo/database generate
```

### ✅ Do this instead

```typescript
// Use safeEnv pattern
"use client";
import { safeEnv } from '#/env';
const env = safeEnv();
const apiKey = env.NEXT_PUBLIC_API_KEY; // ✅

// Use client imports in client components
"use client";
import { useAuth } from '@repo/auth/client/next'; // ✅

// Always regenerate after schema changes
pnpm migrate
pnpm --filter @repo/database generate
```

## Performance Tips

### Server Components

- Use server components by default
- Fetch data in server components
- Use React cache for expensive operations

### Client Components

- Use client components only when needed
- Implement proper loading states
- Use optimistic updates for better UX

### Database

- Use select/include to limit data
- Implement proper indexing
- Use batch operations when possible

## Security Best Practices

### Authentication

- Always validate sessions in server actions
- Use proper redirect patterns
- Implement rate limiting

### Data Validation

- Use Zod schemas for all inputs
- Validate on both client and server
- Sanitize user inputs

### Environment Variables

- Never expose secrets to client
- Use proper environment validation
- Use Doppler for production secrets
